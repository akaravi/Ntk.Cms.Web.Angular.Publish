"use strict";(self.webpackChunkntk_cms_web=self.webpackChunkntk_cms_web||[]).push([[3444],{70532:(T,M,a)=>{a.d(M,{t:()=>r});var r=(()=>{return(o=r||(r={}))[o.none=0]="none",o[o.add=1]="add",o[o.edit=2]="edit",o[o.delete=3]="delete",o[o.list=4]="list",o[o.select=5]="select",r;var o})()},81447:(T,M,a)=>{a.d(M,{t:()=>o});var r=a(86889);class o{constructor(){(0,r.Z)(this,"lat",void 0),(0,r.Z)(this,"lon",void 0)}}},25897:(T,M,a)=>{a.d(M,{Y:()=>P});var r=a(86889),o=a(64537),t=a(5998);let P=(()=>{class _{constructor(C){(0,r.Z)(this,"sanitizer",void 0),this.sanitizer=C}transform(C){return"cms-RecordStatusEnum-cell-"+C}}return(0,r.Z)(_,"\u0275fac",function(C){return new(C||_)(o.Y36(t.H7,16))}),(0,r.Z)(_,"\u0275pipe",o.Yjl({name:"statusCellClass",type:_,pure:!0})),_})()},76609:(T,M,a)=>{a.d(M,{D:()=>s});var r=a(8239),o=a(86889),t=a(64537),P=a(20092),_=a(34511),D=a(57445),C=a(51927),I=a(83151),f=a(42147),L=a(61528),c=a(27969),m=a(60656),E=a(56707),v=a(88692),S=a(61637),Z=a(1379),y=a(88659),R=a(83331),W=a(39665),K=a(75738),U=a(81418);function d(p,g){if(1&p&&(t._UZ(0,"img",9),t.ALo(1,"cmsthumbnail")),2&p){const e=t.oxw().$implicit;t.s9C("src",t.lcZ(1,1,e.linkImageIdSrc),t.LSH)}}function O(p,g){if(1&p&&(t.TgZ(0,"mat-option",7),t.YNc(1,d,2,3,"img",8),t.TgZ(2,"span"),t._uU(3),t.qZA()()),2&p){const e=g.$implicit,i=t.oxw();t.Q6J("value",e)("disabled",i.optionDisabled),t.xp6(1),t.Q6J("ngIf",e.linkImageIdSrc),t.xp6(2),t.Oqu(i.displayOption(e))}}function n(p,g){if(1&p){const e=t.EpF();t.TgZ(0,"mat-icon",10),t.NdJ("click",function(){t.CHM(e);const h=t.oxw();return t.KtG(h.onActionSelectClear())}),t._uU(1,"close"),t.qZA()}}const l=["*"];let s=(()=>{class p{constructor(e,i,h,A){(0,o.Z)(this,"coreEnumService",void 0),(0,o.Z)(this,"translate",void 0),(0,o.Z)(this,"cdr",void 0),(0,o.Z)(this,"categoryService",void 0),(0,o.Z)(this,"id",++p.nextId),(0,o.Z)(this,"dataModelResult",new _.y$4),(0,o.Z)(this,"dataModelSelect",new _.Dp$),(0,o.Z)(this,"formControl",new P.NI),(0,o.Z)(this,"filteredOptions",void 0),(0,o.Z)(this,"optionDisabled",!1),(0,o.Z)(this,"optionSelectFirstItem",!1),(0,o.Z)(this,"optionPlaceholder",""),(0,o.Z)(this,"optionChange",new t.vpe),(0,o.Z)(this,"optionReload",()=>this.onActionReload()),(0,o.Z)(this,"loading",new m.O),this.coreEnumService=e,this.translate=i,this.cdr=h,this.categoryService=A,this.loading.cdr=this.cdr,this.loading.message=this.translate.instant("MESSAGE.Receiving_information")}set optionSelectForce(e){this.onActionSelectForce(e)}get optionLoading(){return this.loading}set optionLoading(e){this.loading=e}ngOnInit(){this.loadOptions()}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe((0,C.O)(""),(0,I.b)(1500),(0,f.x)(),(0,L.w)(e=>this.DataGetAll("string"==typeof e||"number"==typeof e?e:"")))}displayFn(e){return e&&e.virtual_Parent&&e.virtual_Parent.title.length>0&&e.virtual_Parent.virtual_Parent&&e.virtual_Parent.virtual_Parent.title.length>0&&e.virtual_Parent.virtual_Parent.virtual_Parent&&e.virtual_Parent.virtual_Parent.virtual_Parent.title.length>0?e.virtual_Parent.virtual_Parent.virtual_Parent.titleML+" > "+e.virtual_Parent.virtual_Parent.titleML+" > "+e.virtual_Parent.titleML+" > "+e.titleML:e&&e.virtual_Parent&&e.virtual_Parent.title.length>0&&e.virtual_Parent.virtual_Parent&&e.virtual_Parent.virtual_Parent.title.length>0?e.virtual_Parent.virtual_Parent.titleML+" > "+e.virtual_Parent.titleML+" > "+e.titleML:e&&e.virtual_Parent&&e.virtual_Parent.title.length>0?e.virtual_Parent.titleML+" > "+e.titleML:e?e.titleML:void 0}displayOption(e){return e&&e.virtual_Parent&&e.virtual_Parent.title.length>0&&e.virtual_Parent.virtual_Parent&&e.virtual_Parent.virtual_Parent.title.length>0&&e.virtual_Parent.virtual_Parent.virtual_Parent&&e.virtual_Parent.virtual_Parent.virtual_Parent.title.length>0?e.virtual_Parent.virtual_Parent.virtual_Parent.titleML+" > "+e.virtual_Parent.virtual_Parent.titleML+" > "+e.virtual_Parent.titleML+" > "+e.titleML:e&&e.virtual_Parent&&e.virtual_Parent.title.length>0&&e.virtual_Parent.virtual_Parent&&e.virtual_Parent.virtual_Parent.title.length>0?e.virtual_Parent.virtual_Parent.titleML+" > "+e.virtual_Parent.titleML+" > "+e.titleML:e&&e.virtual_Parent&&e.virtual_Parent.title.length>0?e.virtual_Parent.titleML+" > "+e.titleML:e?e.titleML:void 0}DataGetAll(e){var i=this;return(0,r.Z)(function*(){const h=new _.Hay;if(h.rowPerPage=20,h.accessLoad=!0,e&&e.length>0){let u=new _.AO3;u=new _.AO3,u.propertyName="Symbol",u.value=e,u.searchType=_.J6G.Contains,u.clauseType=_.ppe.Or,h.filters.push(u),u=new _.AO3,u.propertyName="Title",u.value=e,u.searchType=_.J6G.Contains,u.clauseType=_.ppe.Or,h.filters.push(u),e&&"number"==typeof+e&&+e>0&&(u=new _.AO3,u.propertyName="Id",u.value=e,u.searchType=_.J6G.Equal,u.clauseType=_.ppe.Or,h.filters.push(u))}const A=i.constructor.name+"main";return i.loading.Start(A),yield(0,D.z)(i.categoryService.ServiceGetAll(h)).then(u=>(i.dataModelResult=u,i.optionSelectFirstItem&&(!i.dataModelSelect||!i.dataModelSelect.id||i.dataModelSelect.id<=0)&&i.dataModelResult.listItems.length>0&&(i.optionSelectFirstItem=!1,setTimeout(()=>{i.formControl.setValue(i.dataModelResult.listItems[0])},1e3),i.onActionSelect(i.dataModelResult.listItems[0])),i.loading.Stop(A),u.listItems))})()}onActionSelect(e){this.optionDisabled||(this.dataModelSelect=e,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.dataModelSelect=null,this.formControl.setValue(null),this.optionChange.emit(null))}push(e){return this.filteredOptions.pipe((0,c.U)(i=>(i.find(h=>h.id===e.id)||i.push(e),i)))}onActionSelectForce(e){if("number"==typeof e&&e>0){if(this.dataModelSelect&&this.dataModelSelect.id===e)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(i=>i.id===e)){const i=this.dataModelResult.listItems.find(h=>h.id===e);return this.dataModelSelect=i,void this.formControl.setValue(i)}this.categoryService.ServiceGetOneIncludeParent(e).subscribe(i=>{i.isSuccess&&(this.filteredOptions=this.push(i.item),this.dataModelSelect=i.item,this.formControl.setValue(i.item),this.optionChange.emit(i.item))})}else{if(typeof e==typeof _.Dp$)return this.filteredOptions=this.push(e),this.dataModelSelect=e,void this.formControl.setValue(e);this.formControl.setValue(null)}}onActionReload(){this.dataModelSelect=new _.Dp$,this.loadOptions()}}return(0,o.Z)(p,"nextId",0),(0,o.Z)(p,"\u0275fac",function(e){return new(e||p)(t.Y36(_.FLW),t.Y36(E.sK),t.Y36(t.sBO),t.Y36(_.XRW))}),(0,o.Z)(p,"\u0275cmp",t.Xpm({type:p,selectors:[["app-cms-location-selector"]],inputs:{optionDisabled:"optionDisabled",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionReload:"optionReload",optionSelectForce:"optionSelectForce",optionLoading:"optionLoading"},outputs:{optionChange:"optionChange"},ngContentSelectors:l,decls:9,vars:10,consts:[[1,"ntk-full-width"],[3,"options"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["matauto","matAutocomplete"],[3,"value","disabled",4,"ngFor","ngForOf"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[3,"value","disabled"],["style","vertical-align:middle;","class","ntk-hover-zoom","aria-hidden","","height","25","width","25",3,"src",4,"ngIf"],["aria-hidden","","height","25","width","25",1,"ntk-hover-zoom",2,"vertical-align","middle",3,"src"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"]],template:function(e,i){if(1&e&&(t.F$t(),t.TgZ(0,"mat-form-field",0),t._UZ(1,"app-progress-spinner",1)(2,"input",2),t.TgZ(3,"mat-autocomplete",3,4),t.NdJ("optionSelected",function(A){return i.onActionSelect(A.option.value)}),t.YNc(5,O,4,4,"mat-option",5),t.ALo(6,"async"),t.qZA(),t.YNc(7,n,2,0,"mat-icon",6),t.Hsn(8),t.qZA()),2&e){const h=t.MAs(4);t.xp6(1),t.Q6J("options",i.loading),t.xp6(1),t.s9C("placeholder",i.optionPlaceholder),t.Q6J("formControl",i.formControl)("matAutocomplete",h),t.uIk("disabled",!!i.optionDisabled||null),t.xp6(1),t.Q6J("displayWith",i.displayFn),t.xp6(2),t.Q6J("ngForOf",t.lcZ(6,8,i.filteredOptions)),t.xp6(2),t.Q6J("ngIf",null==i.dataModelSelect?null:i.dataModelSelect.id)}},dependencies:[v.sg,v.O5,P.Fj,P.JJ,P.oH,S.XC,Z.ey,S.ZL,y.KE,y.R9,R.Hw,W.Nt,K.O,v.Ov,U.v],encapsulation:2})),p})()},17407:(T,M,a)=>{a.d(M,{r:()=>I});var r=a(86889),o=a(64537),t=a(64216),_=a(92340),D=a(32607),C=a(27128);let I=(()=>{class f{set optonCenter(c){this.map&&c&&c.lat&&c.lon&&0!==c.lat&&0!==c.lon&&this.map.setView(new t.LatLng(c.lat,c.lon),this.zoom)}set optionCurrentPoint(c){this.onActionCurrentPoint(c)}constructor(c){(0,r.Z)(this,"cmsToastrService",void 0),(0,r.Z)(this,"id",++f.nextId),(0,r.Z)(this,"map$",new o.vpe),(0,r.Z)(this,"zoom$",new o.vpe),(0,r.Z)(this,"options",{layers:[(0,t.tileLayer)(_.N.leafletUrl,{opacity:.7,maxZoom:19,detectRetina:!0})],zoom:16,center:[32.684985,51.6359425]}),(0,r.Z)(this,"map",void 0),(0,r.Z)(this,"zoom",void 0),(0,r.Z)(this,"destroy",!1),this.cmsToastrService=c}ngOnInit(){const v=t.icon({iconRetinaUrl:"assets/leaflet/marker-icon-2x.png",iconUrl:"assets/leaflet/marker-icon.png",shadowUrl:"assets/leaflet/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]});t.Marker.prototype.options.icon=v}ngAfterViewInit(){}ngOnDestroy(){this.map&&(this.map.clearAllEventListeners(),this.destroy=!0)}onMapReady(c){setTimeout(()=>{this.map&&!this.destroy&&c.invalidateSize()},500),this.map=c,this.map$.emit(c),this.zoom=c.getZoom(),this.zoom$.emit(this.zoom)}onMapZoomEnd(c){this.zoom=c.target.getZoom(),this.zoom$.emit(this.zoom)}onActionCurrentPoint(c=!0){this.getPosition().then(m=>{this.map.setView(new t.LatLng(m.lat,m.lon),this.zoom)})}getPosition(){return new Promise((c,m)=>{navigator.geolocation.getCurrentPosition(E=>{c({lon:E.coords.longitude,lat:E.coords.latitude})},E=>{this.cmsToastrService.typeErrorGetPosition()})})}}return(0,r.Z)(f,"nextId",0),(0,r.Z)(f,"\u0275fac",function(c){return new(c||f)(o.Y36(D.e))}),(0,r.Z)(f,"\u0275cmp",o.Xpm({type:f,selectors:[["app-cms-map"]],inputs:{options:"options",optonCenter:"optonCenter",optionCurrentPoint:"optionCurrentPoint"},outputs:{map$:"map$",zoom$:"zoom$"},decls:1,vars:1,consts:[["leaflet","",1,"map-container",3,"leafletOptions","leafletMapReady","leafletMapZoomEnd"]],template:function(c,m){1&c&&(o.TgZ(0,"div",0),o.NdJ("leafletMapReady",function(v){return m.onMapReady(v)})("leafletMapZoomEnd",function(v){return m.onMapZoomEnd(v)}),o.qZA()),2&c&&o.Q6J("leafletOptions",m.options)},dependencies:[C.je],styles:[".map-container[_ngcontent-%COMP%]{width:100%;height:300px}"]})),f})()},69831:(T,M,a)=>{a.d(M,{u:()=>U});var r=a(86889),o=a(35436),t=a(64537),P=a(20092),_=a(34511),D=a(51927),C=a(83151),I=a(61528),f=a(27969),L=a(32607),c=a(88692),m=a(61637),E=a(1379),v=a(27084),S=a(88659),Z=a(83331);const y=["tagInput"];function R(d,O){if(1&d){const n=t.EpF();t.TgZ(0,"mat-chip",9),t.NdJ("removed",function(){const p=t.CHM(n).$implicit,g=t.oxw();return t.KtG(g.remove(p))}),t._uU(1),t.TgZ(2,"button",10)(3,"mat-icon"),t._uU(4,"cancel"),t.qZA()()()}if(2&d){const n=O.$implicit;t.xp6(1),t.hij(" ",n.display," ")}}function W(d,O){if(1&d&&(t.TgZ(0,"mat-option",11),t._uU(1),t.qZA()),2&d){const n=O.$implicit;t.Q6J("value",n),t.xp6(1),t.hij(" ",n.display," ")}}let U=(()=>{class d{constructor(n,l){(0,r.Z)(this,"service",void 0),(0,r.Z)(this,"cmsToastrService",void 0),(0,r.Z)(this,"id",++d.nextId),(0,r.Z)(this,"optionDisabled",!1),(0,r.Z)(this,"tagInput",void 0),(0,r.Z)(this,"optionPlaceholder","+ Tag"),(0,r.Z)(this,"optionLabel"," Select"),(0,r.Z)(this,"optionChange",new t.vpe),(0,r.Z)(this,"tagDataModel",[]),(0,r.Z)(this,"tagLastDataModel",[]),(0,r.Z)(this,"selectForceStatus",!0),(0,r.Z)(this,"separatorKeysCodes",[o.K5]),(0,r.Z)(this,"tagCtrl",new P.NI("")),(0,r.Z)(this,"filteredOptions",void 0),(0,r.Z)(this,"addOnBlur",!0),this.service=n,this.cmsToastrService=l,this.filteredOptions=this.tagCtrl.valueChanges.pipe((0,D.O)(null),(0,C.b)(400),(0,I.w)(s=>this.filter(s||"")))}set optionSelectForce(n){this.onActionSelectForce(n)}ngOnInit(){}filter(n){const l=new _.Hay;l.rowPerPage=20,l.accessLoad=!0;let s=new _.AO3;return s.propertyName="Title",s.value=n,s.searchType=_.J6G.Contains,s.clauseType=_.ppe.Or,l.filters.push(s),n&&"number"==typeof+n&&+n>0&&(s=new _.AO3,s.propertyName="Id",s.value=n,s.searchType=_.J6G.Equal,s.clauseType=_.ppe.Or,l.filters.push(s)),this.service.ServiceGetAll(l).pipe((0,f.U)(p=>(this.tagLastDataModel=p.listItems.map(g=>({display:g.title,value:g.id})),this.tagLastDataModel)))}checkIndex(n){let l=0,s=-1;return this.tagDataModel.forEach(p=>{p.value==n&&(s=l),l++}),s}add(n){let l;n.value&&this.tagLastDataModel.forEach(s=>{(s.display==n.value||s.value+""==n.value)&&(l=s)}),l&&this.checkIndex(l.value)<0&&(this.tagDataModel.push(l),this.onActionChange()),n.chipInput.clear(),this.tagCtrl.setValue(null)}remove(n){const l=this.checkIndex(n.value);l>=0&&(this.tagDataModel.splice(l,1),this.onActionChange())}selected(n){const l=n.option.value;this.checkIndex(l.value)<0&&this.tagDataModel.push(l),this.tagInput.nativeElement.value="",this.tagCtrl.setValue(null),this.onActionChange()}onActionChange(){const n=[];this.tagDataModel.forEach(l=>{n.findIndex(s=>s==l.value)<0&&n.push(l.value)}),this.selectForceStatus=!1,this.optionChange.emit(n)}onActionSelectForce(n){if(!this.selectForceStatus||!n||0===n.length)return;const l=new _.Hay;n.forEach(s=>{if(s>0){const p=new _.AO3;p.propertyName="Id",p.value=s,p.clauseType=_.ppe.Or,l.filters.push(p)}}),this.service.ServiceGetAll(l).pipe((0,f.U)(s=>{s.isSuccess?s.listItems.forEach(p=>{this.tagDataModel.findIndex(g=>g.value==p.id)<0&&this.tagDataModel.push({value:p.id,display:p.title})}):this.cmsToastrService.typeErrorGetAll(s.errorMessage)},s=>{this.cmsToastrService.typeErrorGetAll(s)})).toPromise()}}return(0,r.Z)(d,"nextId",0),(0,r.Z)(d,"\u0275fac",function(n){return new(n||d)(t.Y36(_.dF2),t.Y36(L.e))}),(0,r.Z)(d,"\u0275cmp",t.Xpm({type:d,selectors:[["app-cms-tag-autocomplete"]],viewQuery:function(n,l){if(1&n&&t.Gf(y,5),2&n){let s;t.iGM(s=t.CRH())&&(l.tagInput=s.first)}},inputs:{optionDisabled:"optionDisabled",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},decls:12,vars:12,consts:[["appearance","fill",2,"width","100%"],["aria-label","tag selection",3,"disabled"],["chipList",""],[3,"removed",4,"ngFor","ngForOf"],[3,"placeholder","matChipInputAddOnBlur","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["tagInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"removed"],["matChipRemove",""],[3,"value"]],template:function(n,l){if(1&n&&(t.TgZ(0,"mat-form-field",0)(1,"mat-label"),t._uU(2),t.qZA(),t.TgZ(3,"mat-chip-grid",1,2),t.YNc(5,R,5,1,"mat-chip",3),t.TgZ(6,"input",4,5),t.NdJ("matChipInputTokenEnd",function(p){return l.add(p)}),t.qZA()(),t.TgZ(8,"mat-autocomplete",6,7),t.NdJ("optionSelected",function(p){return l.selected(p)}),t.YNc(10,W,2,2,"mat-option",8),t.ALo(11,"async"),t.qZA()()),2&n){const s=t.MAs(4),p=t.MAs(9);t.xp6(2),t.Oqu(l.optionLabel),t.xp6(1),t.Q6J("disabled",l.optionDisabled),t.xp6(2),t.Q6J("ngForOf",l.tagDataModel),t.xp6(1),t.Q6J("placeholder",l.optionPlaceholder)("matChipInputAddOnBlur",l.addOnBlur)("formControl",l.tagCtrl)("matAutocomplete",p)("matChipInputFor",s)("matChipInputSeparatorKeyCodes",l.separatorKeysCodes),t.xp6(4),t.Q6J("ngForOf",t.lcZ(11,10,l.filteredOptions))}},dependencies:[c.sg,P.Fj,P.JJ,P.oH,m.XC,E.ey,m.ZL,v.HS,v.RA,v.oH,v.qH,S.KE,S.hX,Z.Hw,c.Ov],encapsulation:2})),d})()}}]);