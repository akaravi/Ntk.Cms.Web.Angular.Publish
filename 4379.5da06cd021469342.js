"use strict";(self.webpackChunkntk_cms_web=self.webpackChunkntk_cms_web||[]).push([[4379],{70532:(y,C,a)=>{a.d(C,{t:()=>s});var s=(()=>{return(n=s||(s={}))[n.none=0]="none",n[n.add=1]="add",n[n.edit=2]="edit",n[n.delete=3]="delete",n[n.list=4]="list",n[n.select=5]="select",s;var n})()},81447:(y,C,a)=>{a.d(C,{t:()=>n});var s=a(86889);class n{constructor(){(0,s.Z)(this,"lat",void 0),(0,s.Z)(this,"lon",void 0)}}},76609:(y,C,a)=>{a.d(C,{D:()=>l});var s=a(8239),n=a(86889),t=a(64537),M=a(20092),c=a(34511),D=a(57445),A=a(51927),T=a(83151),f=a(42147),I=a(61528),p=a(27969),m=a(60656),g=a(56707),v=a(88692),L=a(61637),Z=a(1379),S=a(88659),R=a(83331),K=a(39665),W=a(75738),U=a(81418);function h(_,P){if(1&_&&(t._UZ(0,"img",9),t.ALo(1,"cmsthumbnail")),2&_){const e=t.oxw().$implicit;t.s9C("src",t.lcZ(1,1,e.linkImageIdSrc),t.LSH)}}function E(_,P){if(1&_&&(t.TgZ(0,"mat-option",7),t.YNc(1,h,2,3,"img",8),t.TgZ(2,"span"),t._uU(3),t.qZA()()),2&_){const e=P.$implicit,o=t.oxw();t.Q6J("value",e)("disabled",o.optionDisabled),t.xp6(1),t.Q6J("ngIf",e.linkImageIdSrc),t.xp6(2),t.Oqu(o.displayOption(e))}}function i(_,P){if(1&_){const e=t.EpF();t.TgZ(0,"mat-icon",10),t.NdJ("click",function(){t.CHM(e);const d=t.oxw();return t.KtG(d.onActionSelectClear())}),t._uU(1,"close"),t.qZA()}}const r=["*"];let l=(()=>{class _{constructor(e,o,d,O){(0,n.Z)(this,"coreEnumService",void 0),(0,n.Z)(this,"translate",void 0),(0,n.Z)(this,"cdr",void 0),(0,n.Z)(this,"categoryService",void 0),(0,n.Z)(this,"id",++_.nextId),(0,n.Z)(this,"dataModelResult",new c.y$4),(0,n.Z)(this,"dataModelSelect",new c.Dp$),(0,n.Z)(this,"formControl",new M.NI),(0,n.Z)(this,"filteredOptions",void 0),(0,n.Z)(this,"optionDisabled",!1),(0,n.Z)(this,"optionSelectFirstItem",!1),(0,n.Z)(this,"optionPlaceholder",""),(0,n.Z)(this,"optionChange",new t.vpe),(0,n.Z)(this,"optionReload",()=>this.onActionReload()),(0,n.Z)(this,"loading",new m.O),this.coreEnumService=e,this.translate=o,this.cdr=d,this.categoryService=O,this.loading.cdr=this.cdr,this.loading.message=this.translate.instant("MESSAGE.Receiving_information")}set optionSelectForce(e){this.onActionSelectForce(e)}get optionLoading(){return this.loading}set optionLoading(e){this.loading=e}ngOnInit(){this.loadOptions()}loadOptions(){this.filteredOptions=this.formControl.valueChanges.pipe((0,A.O)(""),(0,T.b)(1500),(0,f.x)(),(0,I.w)(e=>this.DataGetAll("string"==typeof e||"number"==typeof e?e:"")))}displayFn(e){return e&&e.virtual_Parent&&e.virtual_Parent.title.length>0&&e.virtual_Parent.virtual_Parent&&e.virtual_Parent.virtual_Parent.title.length>0&&e.virtual_Parent.virtual_Parent.virtual_Parent&&e.virtual_Parent.virtual_Parent.virtual_Parent.title.length>0?e.virtual_Parent.virtual_Parent.virtual_Parent.titleML+" > "+e.virtual_Parent.virtual_Parent.titleML+" > "+e.virtual_Parent.titleML+" > "+e.titleML:e&&e.virtual_Parent&&e.virtual_Parent.title.length>0&&e.virtual_Parent.virtual_Parent&&e.virtual_Parent.virtual_Parent.title.length>0?e.virtual_Parent.virtual_Parent.titleML+" > "+e.virtual_Parent.titleML+" > "+e.titleML:e&&e.virtual_Parent&&e.virtual_Parent.title.length>0?e.virtual_Parent.titleML+" > "+e.titleML:e?e.titleML:void 0}displayOption(e){return e&&e.virtual_Parent&&e.virtual_Parent.title.length>0&&e.virtual_Parent.virtual_Parent&&e.virtual_Parent.virtual_Parent.title.length>0&&e.virtual_Parent.virtual_Parent.virtual_Parent&&e.virtual_Parent.virtual_Parent.virtual_Parent.title.length>0?e.virtual_Parent.virtual_Parent.virtual_Parent.titleML+" > "+e.virtual_Parent.virtual_Parent.titleML+" > "+e.virtual_Parent.titleML+" > "+e.titleML:e&&e.virtual_Parent&&e.virtual_Parent.title.length>0&&e.virtual_Parent.virtual_Parent&&e.virtual_Parent.virtual_Parent.title.length>0?e.virtual_Parent.virtual_Parent.titleML+" > "+e.virtual_Parent.titleML+" > "+e.titleML:e&&e.virtual_Parent&&e.virtual_Parent.title.length>0?e.virtual_Parent.titleML+" > "+e.titleML:e?e.titleML:void 0}DataGetAll(e){var o=this;return(0,s.Z)(function*(){const d=new c.Hay;if(d.rowPerPage=20,d.accessLoad=!0,e&&e.length>0){let u=new c.AO3;u=new c.AO3,u.propertyName="Symbol",u.value=e,u.searchType=c.b3P.Contains,u.clauseType=c.KT6.Or,d.filters.push(u),u=new c.AO3,u.propertyName="Title",u.value=e,u.searchType=c.b3P.Contains,u.clauseType=c.KT6.Or,d.filters.push(u),e&&"number"==typeof+e&&+e>0&&(u=new c.AO3,u.propertyName="Id",u.value=e,u.searchType=c.b3P.Equal,u.clauseType=c.KT6.Or,d.filters.push(u))}const O=o.constructor.name+"main";return o.loading.Start(O),yield(0,D.z)(o.categoryService.ServiceGetAll(d)).then(u=>(o.dataModelResult=u,o.optionSelectFirstItem&&(!o.dataModelSelect||!o.dataModelSelect.id||o.dataModelSelect.id<=0)&&o.dataModelResult.listItems.length>0&&(o.optionSelectFirstItem=!1,setTimeout(()=>{o.formControl.setValue(o.dataModelResult.listItems[0])},1e3),o.onActionSelect(o.dataModelResult.listItems[0])),o.loading.Stop(O),u.listItems))})()}onActionSelect(e){this.optionDisabled||(this.dataModelSelect=e,this.optionChange.emit(this.dataModelSelect))}onActionSelectClear(){this.optionDisabled||(this.formControl.setValue(null),this.optionChange.emit(null))}push(e){return this.filteredOptions.pipe((0,p.U)(o=>(o.find(d=>d.id===e.id)||o.push(e),o)))}onActionSelectForce(e){if("number"==typeof e&&e>0){if(this.dataModelSelect&&this.dataModelSelect.id===e)return;if(this.dataModelResult&&this.dataModelResult.listItems&&this.dataModelResult.listItems.find(o=>o.id===e)){const o=this.dataModelResult.listItems.find(d=>d.id===e);return this.dataModelSelect=o,void this.formControl.setValue(o)}this.categoryService.ServiceGetOneIncludeParent(e).subscribe(o=>{o.isSuccess&&(this.filteredOptions=this.push(o.item),this.dataModelSelect=o.item,this.formControl.setValue(o.item),this.optionChange.emit(o.item))})}else{if(typeof e==typeof c.Dp$)return this.filteredOptions=this.push(e),this.dataModelSelect=e,void this.formControl.setValue(e);this.formControl.setValue(null)}}onActionReload(){this.dataModelSelect=new c.Dp$,this.loadOptions()}}return(0,n.Z)(_,"nextId",0),(0,n.Z)(_,"\u0275fac",function(e){return new(e||_)(t.Y36(c.FLW),t.Y36(g.sK),t.Y36(t.sBO),t.Y36(c.XRW))}),(0,n.Z)(_,"\u0275cmp",t.Xpm({type:_,selectors:[["app-cms-location-selector"]],inputs:{optionDisabled:"optionDisabled",optionSelectFirstItem:"optionSelectFirstItem",optionPlaceholder:"optionPlaceholder",optionReload:"optionReload",optionSelectForce:"optionSelectForce",optionLoading:"optionLoading"},outputs:{optionChange:"optionChange"},ngContentSelectors:r,decls:9,vars:10,consts:[[1,"ntk-full-width"],[3,"options"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto34","matAutocomplete"],[3,"value","disabled",4,"ngFor","ngForOf"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[3,"value","disabled"],["style","vertical-align:middle;","class","ntk-hover-zoom","aria-hidden","","height","25","width","25",3,"src",4,"ngIf"],["aria-hidden","","height","25","width","25",1,"ntk-hover-zoom",2,"vertical-align","middle",3,"src"],["matSuffix","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"]],template:function(e,o){if(1&e&&(t.F$t(),t.TgZ(0,"mat-form-field",0),t._UZ(1,"app-progress-spinner",1)(2,"input",2),t.TgZ(3,"mat-autocomplete",3,4),t.NdJ("optionSelected",function(O){return o.onActionSelect(O.option.value)}),t.YNc(5,E,4,4,"mat-option",5),t.ALo(6,"async"),t.qZA(),t.YNc(7,i,2,0,"mat-icon",6),t.Hsn(8),t.qZA()),2&e){const d=t.MAs(4);t.xp6(1),t.Q6J("options",o.loading),t.xp6(1),t.s9C("placeholder",o.optionPlaceholder),t.Q6J("formControl",o.formControl)("matAutocomplete",d),t.uIk("disabled",!!o.optionDisabled||null),t.xp6(1),t.Q6J("displayWith",o.displayFn),t.xp6(2),t.Q6J("ngForOf",t.lcZ(6,8,o.filteredOptions)),t.xp6(2),t.Q6J("ngIf",o.dataModelSelect.id)}},dependencies:[v.sg,v.O5,M.Fj,M.JJ,M.oH,L.XC,Z.ey,L.ZL,S.KE,S.R9,R.Hw,K.Nt,W.O,v.Ov,U.v],encapsulation:2})),_})()},17407:(y,C,a)=>{a.d(C,{r:()=>T});var s=a(86889),n=a(64537),t=a(64216),c=a(92340),D=a(32607),A=a(27128);let T=(()=>{class f{set optonCenter(p){this.map&&p&&p.lat&&p.lon&&0!==p.lat&&0!==p.lon&&this.map.setView(new t.LatLng(p.lat,p.lon),this.zoom)}set optionCurrentPoint(p){this.onActionCurrentPoint(p)}constructor(p){(0,s.Z)(this,"cmsToastrService",void 0),(0,s.Z)(this,"id",++f.nextId),(0,s.Z)(this,"map$",new n.vpe),(0,s.Z)(this,"zoom$",new n.vpe),(0,s.Z)(this,"options",{layers:[(0,t.tileLayer)(c.N.leafletUrl,{opacity:.7,maxZoom:19,detectRetina:!0})],zoom:16,center:[32.684985,51.6359425]}),(0,s.Z)(this,"map",void 0),(0,s.Z)(this,"zoom",void 0),(0,s.Z)(this,"destroy",!1),this.cmsToastrService=p}ngOnInit(){const v=t.icon({iconRetinaUrl:"assets/leaflet/marker-icon-2x.png",iconUrl:"assets/leaflet/marker-icon.png",shadowUrl:"assets/leaflet/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]});t.Marker.prototype.options.icon=v}ngAfterViewInit(){}ngOnDestroy(){this.map&&(this.map.clearAllEventListeners(),this.destroy=!0)}onMapReady(p){setTimeout(()=>{this.map&&!this.destroy&&p.invalidateSize()},500),this.map=p,this.map$.emit(p),this.zoom=p.getZoom(),this.zoom$.emit(this.zoom)}onMapZoomEnd(p){this.zoom=p.target.getZoom(),this.zoom$.emit(this.zoom)}onActionCurrentPoint(p=!0){this.getPosition().then(m=>{this.map.setView(new t.LatLng(m.lat,m.lon),this.zoom)})}getPosition(){return new Promise((p,m)=>{navigator.geolocation.getCurrentPosition(g=>{p({lon:g.coords.longitude,lat:g.coords.latitude})},g=>{this.cmsToastrService.typeErrorGetPosition()})})}}return(0,s.Z)(f,"nextId",0),(0,s.Z)(f,"\u0275fac",function(p){return new(p||f)(n.Y36(D.e))}),(0,s.Z)(f,"\u0275cmp",n.Xpm({type:f,selectors:[["app-cms-map"]],inputs:{options:"options",optonCenter:"optonCenter",optionCurrentPoint:"optionCurrentPoint"},outputs:{map$:"map$",zoom$:"zoom$"},decls:1,vars:1,consts:[["leaflet","",1,"map-container",3,"leafletOptions","leafletMapReady","leafletMapZoomEnd"]],template:function(p,m){1&p&&(n.TgZ(0,"div",0),n.NdJ("leafletMapReady",function(v){return m.onMapReady(v)})("leafletMapZoomEnd",function(v){return m.onMapZoomEnd(v)}),n.qZA()),2&p&&n.Q6J("leafletOptions",m.options)},dependencies:[A.je],styles:[".map-container[_ngcontent-%COMP%]{width:100%;height:300px}"]})),f})()},69831:(y,C,a)=>{a.d(C,{u:()=>U});var s=a(86889),n=a(35436),t=a(64537),M=a(20092),c=a(34511),D=a(51927),A=a(83151),T=a(61528),f=a(27969),I=a(32607),p=a(88692),m=a(61637),g=a(1379),v=a(27084),L=a(88659),Z=a(83331);const S=["tagInput"];function R(h,E){if(1&h){const i=t.EpF();t.TgZ(0,"mat-chip",9),t.NdJ("removed",function(){const _=t.CHM(i).$implicit,P=t.oxw();return t.KtG(P.remove(_))}),t._uU(1),t.TgZ(2,"button",10)(3,"mat-icon"),t._uU(4,"cancel"),t.qZA()()()}if(2&h){const i=E.$implicit;t.xp6(1),t.hij(" ",i.display," ")}}function K(h,E){if(1&h&&(t.TgZ(0,"mat-option",11),t._uU(1),t.qZA()),2&h){const i=E.$implicit;t.Q6J("value",i),t.xp6(1),t.hij(" ",i.display," ")}}let U=(()=>{class h{constructor(i,r){(0,s.Z)(this,"service",void 0),(0,s.Z)(this,"cmsToastrService",void 0),(0,s.Z)(this,"id",++h.nextId),(0,s.Z)(this,"optionDisabled",!1),(0,s.Z)(this,"tagInput",void 0),(0,s.Z)(this,"optionPlaceholder","+ Tag"),(0,s.Z)(this,"optionLabel"," Select"),(0,s.Z)(this,"optionChange",new t.vpe),(0,s.Z)(this,"tagDataModel",[]),(0,s.Z)(this,"tagLastDataModel",[]),(0,s.Z)(this,"selectForceStatus",!0),(0,s.Z)(this,"separatorKeysCodes",[n.K5]),(0,s.Z)(this,"tagCtrl",new M.NI("")),(0,s.Z)(this,"filteredOptions",void 0),(0,s.Z)(this,"addOnBlur",!0),this.service=i,this.cmsToastrService=r,this.filteredOptions=this.tagCtrl.valueChanges.pipe((0,D.O)(null),(0,A.b)(400),(0,T.w)(l=>this.filter(l||"")))}set optionSelectForce(i){this.onActionSelectForce(i)}ngOnInit(){}filter(i){const r=new c.Hay;r.rowPerPage=20,r.accessLoad=!0;let l=new c.AO3;return l.propertyName="Title",l.value=i,l.searchType=c.b3P.Contains,l.clauseType=c.KT6.Or,r.filters.push(l),i&&"number"==typeof+i&&+i>0&&(l=new c.AO3,l.propertyName="Id",l.value=i,l.searchType=c.b3P.Equal,l.clauseType=c.KT6.Or,r.filters.push(l)),this.service.ServiceGetAll(r).pipe((0,f.U)(_=>(this.tagLastDataModel=_.listItems.map(P=>({display:P.title,value:P.id})),this.tagLastDataModel)))}checkIndex(i){let r=0,l=-1;return this.tagDataModel.forEach(_=>{_.value==i&&(l=r),r++}),l}add(i){let r;i.value&&this.tagLastDataModel.forEach(l=>{(l.display==i.value||l.value+""==i.value)&&(r=l)}),r&&this.checkIndex(r.value)<0&&(this.tagDataModel.push(r),this.onActionChange()),i.chipInput.clear(),this.tagCtrl.setValue(null)}remove(i){const r=this.checkIndex(i.value);r>=0&&(this.tagDataModel.splice(r,1),this.onActionChange())}selected(i){const r=i.option.value;this.checkIndex(r.value)<0&&this.tagDataModel.push(r),this.tagInput.nativeElement.value="",this.tagCtrl.setValue(null),this.onActionChange()}onActionChange(){const i=[];this.tagDataModel.forEach(r=>{i.findIndex(l=>l==r.value)<0&&i.push(r.value)}),this.selectForceStatus=!1,this.optionChange.emit(i)}onActionSelectForce(i){if(!this.selectForceStatus||!i||0===i.length)return;const r=new c.Hay;i.forEach(l=>{if(l>0){const _=new c.AO3;_.propertyName="Id",_.value=l,_.clauseType=c.KT6.Or,r.filters.push(_)}}),this.service.ServiceGetAll(r).pipe((0,f.U)(l=>{l.isSuccess?l.listItems.forEach(_=>{this.tagDataModel.findIndex(P=>P.value==_.id)<0&&this.tagDataModel.push({value:_.id,display:_.title})}):this.cmsToastrService.typeErrorGetAll(l.errorMessage)},l=>{this.cmsToastrService.typeErrorGetAll(l)})).toPromise()}}return(0,s.Z)(h,"nextId",0),(0,s.Z)(h,"\u0275fac",function(i){return new(i||h)(t.Y36(c.dF2),t.Y36(I.e))}),(0,s.Z)(h,"\u0275cmp",t.Xpm({type:h,selectors:[["app-cms-tag-autocomplete"]],viewQuery:function(i,r){if(1&i&&t.Gf(S,5),2&i){let l;t.iGM(l=t.CRH())&&(r.tagInput=l.first)}},inputs:{optionDisabled:"optionDisabled",optionPlaceholder:"optionPlaceholder",optionLabel:"optionLabel",optionSelectForce:"optionSelectForce"},outputs:{optionChange:"optionChange"},decls:12,vars:12,consts:[["appearance","fill",2,"width","100%"],["aria-label","tag selection",3,"disabled"],["chipList",""],[3,"removed",4,"ngFor","ngForOf"],[3,"placeholder","matChipInputAddOnBlur","formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["tagInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"removed"],["matChipRemove",""],[3,"value"]],template:function(i,r){if(1&i&&(t.TgZ(0,"mat-form-field",0)(1,"mat-label"),t._uU(2),t.qZA(),t.TgZ(3,"mat-chip-grid",1,2),t.YNc(5,R,5,1,"mat-chip",3),t.TgZ(6,"input",4,5),t.NdJ("matChipInputTokenEnd",function(_){return r.add(_)}),t.qZA()(),t.TgZ(8,"mat-autocomplete",6,7),t.NdJ("optionSelected",function(_){return r.selected(_)}),t.YNc(10,K,2,2,"mat-option",8),t.ALo(11,"async"),t.qZA()()),2&i){const l=t.MAs(4),_=t.MAs(9);t.xp6(2),t.Oqu(r.optionLabel),t.xp6(1),t.Q6J("disabled",r.optionDisabled),t.xp6(2),t.Q6J("ngForOf",r.tagDataModel),t.xp6(1),t.Q6J("placeholder",r.optionPlaceholder)("matChipInputAddOnBlur",r.addOnBlur)("formControl",r.tagCtrl)("matAutocomplete",_)("matChipInputFor",l)("matChipInputSeparatorKeyCodes",r.separatorKeysCodes),t.xp6(4),t.Q6J("ngForOf",t.lcZ(11,10,r.filteredOptions))}},dependencies:[p.sg,M.Fj,M.JJ,M.oH,m.XC,g.ey,m.ZL,v.HS,v.RA,v.oH,v.qH,L.KE,L.hX,Z.Hw,p.Ov],encapsulation:2})),h})()}}]);